<%= render'application/sidebar' %>
<div class = "content_index">

	<div class = 'icon_box small'>
		<div class ='user_icon'>
			<%= image_tag(@post.user.image.to_s) %>
			<%=link_to "#{@post.user.name}", user_path(@post.user.id), class:'user_show_page' %>
		</div>
	</div>
		<%= @post.title %>
		<%= @post.content %>
		<%= image_tag(@post.image.to_s) %>
	<div class="btn_edit">
		<% if current_user.id == @post.user.id %>
			<%= link_to "投稿編集", edit_post_path(@post),class:"btn btn-outline-success btn-block" %>
			<%= link_to "投稿削除", post_path(@post),method: :delete, data: { confirm: 'Are you sure?'} ,class: "btn btn-outline-success btn-block" %>
		<% end %>
	</div>

		<% unless @post.user_id == current_user.id %>
			<% if @favorite.present? %>
				<%= link_to("/favorites/#{@post.id}/destroy", {method: "post"}) do %>
				<span class="fa fa-heart like-btn-unlike"></span>
				<% end %>
			<% else %>
				<%= link_to("/favorites/#{@post.id}/create", {method: "post"}) do %>
        <span class="fa fa-heart like-btn"></span>
			<% end %>
			<% end %>
		<% end %>
</div>



<div id="map" style='width: 400px; height: 240px;'></div>
  <script type="text/javascript">
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: { scrollwheel: false }, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers([
        {
          "lat": <%= @post.latitude %>,
          "lng": <%= @post.longitude %>,
		  "infowindow": '<p><%= @post.title %></p><p><%= @post.address %></p><p><%= link_to "Googleマップで見る" ,"https://maps.google.co.jp/maps?q=loc:#{@post.latitude},#{@post.longitude}&iwloc=J",target: "_blank" %></p>'
        }
      ]);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(17);
    });
  </script>